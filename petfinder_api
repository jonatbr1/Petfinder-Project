import requests
import hashlib
from lxml import etree

def sig_hash(str_to_hash):
    sig_inputarr = bytearray(str_to_hash, 'utf-8')
    sig_outputarr = hashlib.md5(sig_inputarr)
    return sig_outputarr.hexdigest();

base_url = 'http://api.petfinder.com/'
key = '73a7bdb2d6fb6ff6fbf2ce0795109a58'
secret = '79e4470e7e285d7ff90d08b4939eb16d'
sig = sig_hash(secret + 'key=' + key)


full_url = base_url + 'auth.getToken'
params = {'key': key, 'sig': sig}
response = requests.get(full_url, params=params)
html = response.content

# Parse HTML response to get the Petfinder token
root = etree.fromstring(html)
parser = etree.HTMLParser()
tree = etree.fromstring(html, parser)
token_element = tree.xpath("//token")
token = token_element[0].text
