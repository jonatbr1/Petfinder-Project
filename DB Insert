import csv
import sqlite3

con = sqlite3.connect(":memory:")
cur = con.cursor()
cur.execute("CREATE TABLE t (column1, column2);")

with open('/Users/jonathan.braus/Desktop/Test.csv', 'rt') as file:
    reader = csv.reader(file)
    header = next(reader)
    data = []
    for row  in reader:
        data.append(row)

cols = ''
for col in header:
    cols = cols + col + ','
cols = cols[:-1]
    
cur.executemany("INSERT INTO t (" + cols + ") VALUES (?, ?);", data)
con.commit()
